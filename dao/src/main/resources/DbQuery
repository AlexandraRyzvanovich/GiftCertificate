CREATE TABLE CERTIFICATE (
    id SERIAL  PRIMARY KEY ,
    NAME           VARCHAR(50)   NOT NULL UNIQUE,
    DESCRIPTION    VARCHAR(200)     NOT NULL,
    PRICE        NUMERIC NOT NULL CHECK(PRICE >0),
    CREATION_DATE         DATE NOT NULL,
	MODIFICATION_DATE DATE,
    VALID_DAYS INT CHECK (VALID_DAYS > 0)
);

CREATE TABLE TAG (
    ID SERIAL  PRIMARY KEY ,
    NAME VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE CERTIFICATE_TAG (
    CERTIFICATE_ID INTEGER REFERENCES CERTIFICATE(ID) ON DELETE CASCADE,
	TAG_ID INTEGER REFERENCES TAG(ID) ON DELETE CASCADE,
	PRIMARY KEY (CERTIFICATE_ID, TAG_ID)
);

CREATE TABLE ORDERS (
    ID SERIAL PRIMARY KEY ,
    USER_ID INTEGER REFERENCES USERS(ID) ON DELETE CASCADE,
	DATE DATE NOT NULL,
	AMOUNT NUMERIC NOT NULL CHECK(AMOUNT > 0),
	CERTIFICATE_ID INTEGER REFERENCES CERTIFICATE(ID) ON DELETE CASCADE
);

CREATE TABLE USERS (
    ID SERIAL PRIMARY KEY ,
    EMAIL varchar(200) UNIQUE NOT NULL,
    PASSWORD  varchar(200) NOT NULL
    NAME VARCHAR(50) NOT NULL,
    SURNAME VARCHAR(50) NOT NULL,
    CREATED_DATE DATE NOT NULL
);

CREATE TABLE ROLE (
    ID SERIAL PRIMARY KEY ,
    NAME varchar(255) NOT NULL
);

CREATE TABLE USER_ROLE (
    USER_ID INTEGER REFERENCES USER(ID) ON DELETE CASCADE,
	ROLE_ID INTEGER REFERENCES ROLE(ID) ON DELETE CASCADE,
	PRIMARY KEY (USER_ID, ROLE_ID)
);




